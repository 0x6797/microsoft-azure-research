# Azure に関する考察

## 目次

- [サブスクリプションは細かく分けるべき？](#subscription)
- [開発環境と本番環境で Azure リソースは分けるべきか？](#dev-environment)
- [更新管理は一括で行うべきか？あるいはグループに分けて更新を行うべきか？](#update-management)
- [仮想マシンの数はできるだけ最小限にすべき？](#using-vm)
- [Azure AD は分けるか統合するか？](ad-integration)

## <a id="subscription">サブスクリプションは細かく分けるべき？</a>

- 開発環境と本番環境での請求額を明確に管理したい場合は、環境別にサブスクリプションを分けた方が良さそう
- マルチテナントで運用する場合でそれぞれの顧客別の収支を管理したい場合に、サブスクリプションを分けることは有効か？
  - ただし、たとえば同一インスタンスの IoT Hub をテナントで共有していた場合は、サブスクリプションを分けることはできないので、事前に運用計画を立案すべき

## <a id="dev-environment">開発環境と本番環境で、Azure リソースは分けるべきか？</a>

- 運用、監視を行っていた場合に同一の環境を使用している場合は、統計情報が混ざることによって正しい情報を分析できない
  - したがって、少なくとも開発とテスト、および本番環境は分けた方がよい
  - メッセージルーティングで切り分ける手段もあるにはある。
- パフォーマンステスト環境と本番環境は同じにすべきではない…
- 継続的インテグレーションや継続的デプロイ等の手法を使う場合に、環境を分けることによる管理の煩雑さが許容範囲となるか？
  - 開発環境は継続的インテグレーションの恩恵を受けることができるが、本番環境はどうなるのか？
    - 違うリリースパイプラインが必要になる？
    - あるいは、違うコンテナレジストリが必要になるか？

## <a id="update-management">更新管理は一括で行うべきか？あるいはグループに分けて更新を行うべきか？</a>

- 更新対象を一括で行った場合に、稼働しているシステムに悪影響はでないか？
  - 更新処理中のパフォーマンスの悪化
  - システム再起動によるサービスの停止
- 更新をグループに分けて行った場合は、複数のシステムやサービス、コンポーネントのバージョンが混在してしまう
  - これによるシステムへの悪影響、特にデータの不整合が発生しないか？

## <a id="using-vm">仮想マシンの数はできるだけ最小限にすべき？</a>

- できるだけマネージドサービスを使用するべきか？
  - 細かい制御ができないと困る？
  - 価格が増える？
- 仮想マシンの代替手段は？
  - マネージドサービス？
  - コンテナ？
- DSC の更新が滞っている気がするので仮想マシンの管理がリスク？

## <a id="ad-integration">Azure AD は分けるか統合するか？</a>

- テナントでわける？統合する？
  - ユーザーのドメイン名が共通なら統合するべき？